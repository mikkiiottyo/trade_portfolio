{% extends "base.html" %}

{% block title %}Home Page{% endblock %}

{% block content %}
<h1>Stock Data for {{ stock_symbol }}</h1>

{% if error_message %}
    <p class="text-danger">Error: {{ error_message }}</p>
{% endif %}

{% if 'Invalid Search' not in stock_symbol %}
    <div>
        {{ graph_html|safe }}
    </div>
{% else %}
    <p>This is mock data for a made-up stock.</p>
{% endif %}


<form method="get" action="/">
    <input type="text" name="stock_symbol" placeholder="Enter Stock or Cryptocurrency (e.g., AAPL, Bitcoin)" value="{{ stock_symbol }}">
    <button type="submit">Search</button>
</form>

<hr>

{% if user.is_authenticated %}
    <h2>Trade {{ stock_symbol }}</h2>

    <form method="post" action="">
        {% csrf_token %}
        {{ form.as_p }}

        <div class="btn-group">
            <button type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                Trade Options
            </button>
            <ul class="dropdown-menu">
                <li>
                    <button type="submit" name="action" value="BUY" class="dropdown-item">Buy</button>
                </li>
                <li>
                    <button type="submit" name="action" value="SELL" class="dropdown-item">Sell</button>
                </li>
                <li>
                    <button type="submit" name="action" value="TRADE" class="dropdown-item">Trade</button>
                </li>
            </ul>
        </div>
    </form>

    {% if error %}
        <div class="alert alert-danger mt-3">{{ error }}</div>
    {% endif %}

{% else %}
    <p><a href="{% url 'login' %}">Log in</a> to trade stocks.</p>
{% endif %}

{% endblock %}